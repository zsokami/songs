<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>随便听听</title>
	</head>
	<body>
		<audio controls></audio>
		<p>?sort=网易云<a href="?">热歌榜</a>(默认)/<a href="?sort=新歌榜">新歌榜</a>/<a href="?sort=飙升榜">飙升榜</a>/<a href="?sort=抖音榜">抖音榜</a>/<a href="?sort=电音榜">电音榜</a> (<a href="?sort=飙升榜">?sort=飙升榜</a>)</p>
		<p>?mid=网易云歌单id (<a href="?mid=988690134">?mid=988690134</a>)</p>
		<p>?banana=banana歌曲id/以逗号分割的歌曲id列表/留空 (<a href="?banana">?banana</a>)</p>
		<script>
			const audio = document.querySelector('audio')
			;(audio.onended = async function() {
				const search_obj = Object.fromEntries(new URLSearchParams(location.search))
				if ('banana' in search_obj) {
					let banana_ids
					if (search_obj.banana) {
						banana_ids = search_obj.banana.split(',')
					} else {
						try {
							banana_ids = await fetch('songs')
						} catch {
							banana_ids = await fetch('https://raw.kgithub.com/zsokami/songs/main/songs')
						}
						banana_ids = await banana_ids.text().then(s => s.split('\n').filter(x => x).map(x => x.split('  ').pop()))
					}
					audio.src = 'https://data.mp3-banana.pro/play-track/' + banana_ids[Math.random() * banana_ids.length | 0]
				} else {
					audio.src = 'https://api.uomg.com/api/rand.music' + location.search
				}
				audio.play()
			})()
		</script>
	</body>
</html>
